# ADR-001: Arquitetura Clean + Hexagonal (ForgeBase)

**Status**: Aceito
**Data**: 2025-12-03
**Decisores**: Stakeholder

## Contexto

O ForgeLLMClient precisa de uma arquitetura que permita:
- Testabilidade isolada de componentes
- Troca de provedores LLM sem afetar logica de negocio
- Extensibilidade para novos provedores e funcionalidades
- Alinhamento com o ecossistema Forge (ForgeBase, ForgeProcess)

## Decisao

Adotar **Clean Architecture + Hexagonal Architecture** conforme implementado pelo ForgeBase.

### Estrutura de Camadas

```mermaid
flowchart TB
    subgraph src/forge_llm
        domain["domain/<br/>Nucleo puro (entidades, VOs, excecoes)"]
        application["application/<br/>Casos de uso e orquestracao"]
        infrastructure["infrastructure/<br/>Implementacoes concretas"]
        adapters["adapters/<br/>Interfaces externas"]
    end

    style domain fill:#e8f5e9
    style application fill:#fff3e0
    style infrastructure fill:#e3f2fd
    style adapters fill:#f3e5f5
```

### Regras de Dependencia

```mermaid
flowchart LR
    Domain["Domain"]
    Application["Application"]
    Infrastructure["Infrastructure"]
    Adapters["Adapters"]

    Application --> Domain
    Infrastructure --> Application
    Adapters --> Application

    style Domain fill:#e8f5e9
    style Application fill:#fff3e0
    style Infrastructure fill:#e3f2fd
    style Adapters fill:#f3e5f5
```

### Classes Base

| Componente | Base Class ForgeBase |
|------------|---------------------|
| Entidade | `EntityBase` |
| Value Object | `ValueObjectBase` |
| UseCase | `UseCaseBase` |
| Port | ABC / `PortBase` |
| Adapter | `AdapterBase` |

## Alternativas Consideradas

### 1. Arquitetura em Camadas Simples
- **Pros**: Mais simples inicialmente
- **Contras**: Acoplamento entre camadas, dificil testar

### 2. Arquitetura Modular sem ForgeBase
- **Pros**: Menos dependencias
- **Contras**: Reinventar a roda, perder observabilidade nativa

### 3. Clean + Hexagonal com ForgeBase (ESCOLHIDA)
- **Pros**: Testabilidade, extensibilidade, observabilidade nativa, alinhamento com ecossistema
- **Contras**: Curva de aprendizado inicial

## Consequencias

### Positivas
- Codigo testavel e isolado
- Facil trocar implementacoes (provedores, persistencia)
- Observabilidade nativa via ForgeBase
- Padronizacao com outros projetos Forge

### Negativas
- Mais boilerplate inicial
- Curva de aprendizado para novos desenvolvedores

## Validacao

- [ ] Testes unitarios passam em todas as camadas isoladamente
- [ ] import-linter valida boundaries entre camadas
- [ ] Novos provedores podem ser adicionados sem modificar core

## Referencias

- `docs/guides/forgebase_guides/referencia/arquitetura.md`
- `docs/guides/forgebase_guides/usuarios/forgebase-rules.md`
